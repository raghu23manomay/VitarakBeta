
@{
   
    Layout = "~/Views/Shared/_TempLayout.cshtml";
}

<!DOCTYPE html>

<html>
<head>
    <script src="~/Scripts/jquery-1.12.4.min.js"></script>
    <script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
    <!-- this meta viewport is required for BOLT //-->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <!-- BOLT Sandbox/test //-->
    <script id="bolt" src="https://sboxcheckout-static.citruspay.com/bolt/run/bolt.min.js" bolt-color="e34524" bolt-logo="http://boltiswatching.com/wp-content/uploads/2015/09/Bolt-Logo-e14421724859591.png"></script>
    <!-- BOLT Production/Live //-->
    <!--// script id="bolt" src="https://checkout-static.citruspay.com/bolt/run/bolt.min.js" bolt-color="e34524" bolt-logo="http://boltiswatching.com/wp-content/uploads/2015/09/Bolt-Logo-e14421724859591.png"></script //-->
    <script src="~/Scripts/jquery-1.12.4.min.js"></script>
    <link href="~/WebSite/css/style.css" rel="stylesheet">
    <title>Payementresponce</title>
    <style>
        span.text {
            float: left;
            width: 180px;
        }

        div.dv {
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div id="grid">
        <div class="container" style="margin-top:80px;">

            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel"><i class="fa fa-user-plus marginRight15px" aria-hidden="true"></i> Cost Details</h4>
            </div>
            <div class="modal-body">



                @using (Html.BeginForm("", "", FormMethod.Post, new { @class = "contact - form", runat = "server", id = "payment_form", name = "payment_form" }))
                {
                <div>
                    <div class="row">
                        <div class="col-sm-6">  
                            <div class="single-pricing">
                                <br>
                                <h2>Selected Plan Details</h2>
                                <hr>
                                <div class="pricing-details">

                                    <ul>
                                        <li>Plan Name : <b>@Session["PlanName"]</b></li>
                                        <li>Plan Type : <b>@Session["PlanDesc"]</b></li>
                                        <li>Total Amount : <b>@Session["Total"]</b></li>
                                    </ul>
                                </div>

                            </div> 
                        </div>
                        <div class="col-sm-6">
                            <div class="single-pricing">
                                <br>
                                <h2>User Information</h2>
                                <hr>
                                <div class="pricing-details">
                                    <ul>
                                        <li>Name : <b>@Session["CName"]</b></li>
                                        <li>Business Name :<b>@Session["BusinessName"]</b></li>
                                        <li>Mobile No: <b>@Session["Mobile"]</b></li>
                                        <li>User Name: <b>@Session["UserName"]</b></li>

                                    </ul>
                                    <ul></ul>
                                </div>

                            </div>
                        </div>
                    </div>
                    

                    <input type="hidden" id="udf5" name="udf5" value="raghvendra" />
                    @*<input type="hidden" id="surl" name="surl" value="http://localhost:63906/Action/Payementresponce?Payment=Sucess" />*@
                    <input type="hidden" id="surl" name="surl" value="http://localhost:63906/Action/Payementresponce"/>
                    <div class="dv">
                        @*<span class="text"><label>Merchant Key:</label></span>*@
                        <span><input class="hidden" type="text" id="key" name="key" placeholder="Merchant Key" value="Eoujo5i4" /></span>
                    </div>

                    <div class="dv">
                        @*<span class="text"><label>Merchant Salt:</label></span>*@
                        <span><input class="hidden" type="text" id="salt" name="salt" placeholder="Merchant Salt" value="HBStnJyXeZ" /></span>
                    </div>

                    <div class="container-fluid">

                        <div class="row hidden">

                            <div class="form-group col-md-4 col-sm-4">
                                <label class="control-label">Plan Info:</label>
                                <input type="text" id="pinfo" style="text-align: center;" name="pinfo" class="form-control" placeholder="Product Info" value="@Session["PlanName"]" disabled />

                            </div>
                            <div class="form-group col-md-4 col-sm-4">
                                <label class="control-label">Description</label>
                                <input type="text" id="pdesc" style="text-align: center;" name="pdesc" class="form-control" placeholder="pdesc" value="@Session["PlanDesc"]" disabled />
                            </div>

                            <div class="form-group col-md-4 col-sm-4">
                                <label class="control-label">Transaction/Order ID:</label>
                                <input type="text" id="txnid" style="text-align: center;" name="txnid" class="form-control" placeholder="Transaction ID" value="V8546" disabled />

                            </div>
                        </div>


                        <div class="row hidden">

                            <div class="form-group col-md-4 col-sm-4">
                                <label class="control-label">Registration Rate:</label>
                                @*<input type="text" id="regid" style="text-align: center;" name="regid" class="form-control" placeholder="Transaction ID" value="@Session["regrate"]" disabled />*@

                            </div>

                            <div class="form-group col-md-4 col-sm-4">
                                <label class="control-label">Plan Rate:</label>
                                <input type="text" id="pid" style="text-align: center;" name="pid" class="form-control" placeholder="Product Info" value="@Session["PlanAmount"]" disabled />

                            </div>
                            <div class="form-group col-md-4 col-sm-4">
                                <label class="control-label">Total</label>
                                <input type="text" id="amount" style="text-align: center;" name="amount" class="form-control" placeholder="amount" value="@Session["Total"]" disabled />
                            </div>
                        </div>
                                                                     
                        <div class="row hidden">
                            <div class="col-md-4 col-sm-4">
                                <label class="control-label">First Name:</label>
                                <input type="text" id="fname" name="fname" class="form-control" placeholder="First Name" value="raghvendra" />
                            </div>
                            <div class="col-md-4 col-sm-4">
                                <label class="control-label">Mobile/Cell Number:</label>
                                <input type="text" id="mobile" name="mobile" class="form-control" placeholder="Mobile/Cell Number" value="8237175481" />

                            </div>
                            <div class="col-md-4 col-sm-4">
                                <label class="control-label">Email ID:</label>
                                <input type="text" id="email" name="email" class="form-control" placeholder="Email ID" value="rmudgal23@gmail.com" />

                            </div>

                        </div>

                    </div>

                    <div class="dv">
                        @*<span class="text"><label>Hash:</label></span>*@
                        <span><input class="hidden" type="text" id="hash" name="hash" placeholder="Hash" value="" /></span>
                    </div>
                    <div></div>

                </div>



                    <div class="modal-footer" style="margin-top:18px;">

                        <button type="button" id="reg" class="btn btn-warning" onclick="removclass()" data-dismiss="modal">cancel</button>
                        <input type="submit" class="btn btn-success" value="Pay" onclick="launchBOLT(); return false;" />
                        @*<button id="btnlogin" type="submit" class="btn btn-success">Submit</button>*@

                    </div>
                }
            </div>
            </div>
        </div>

</body>
</html>
<script type="text/javascript">


    $('#months').on('change',function () {

        var fixamt = $('#fixamount').val();
        var month = $('#months').val();
        var total = fixamt * month;
        $('#amount').val(total);

    });

    $(document).ready(function () {
        autohash();
        var paymentstatus = getUrlParameter('Payment');
        if (paymentstatus == 'Sucess') {
            alert('Payment Sucessfull');
        }

        function autohash() {
            $.ajax({
                url: '/Action/Hash',
                type: 'post',
                data: JSON.stringify({
                    key: $('#key').val(),
                    salt: $('#salt').val(),
                    txnid: $('#txnid').val(),
                    amount: $('#amount').val(),
                    pinfo: $('#pinfo').val(),
                    fname: $('#fname').val(),
                    email: $('#email').val(),
                    mobile: $('#mobile').val(),
                    udf5: $('#udf5').val()
                }),
                contentType: "application/json",
                dataType: 'json',
                success: function (json) {
                    if (json['error']) {
                        $('#alertinfo').html('<i class="fa fa-info-circle"></i>' + json['error']);
                        $('#alertinfo').val(json['error']);
                    }
                    else if (json['success']) {
                        $('#hash').val(json['success']);
                    }
                }
            });
        }

    });

</script>
<script type="text/javascript">
<!--
    function launchBOLT() {
        bolt.launch({
            key: $('#key').val(),
            txnid: $('#txnid').val(),
            hash: $('#hash').val(),
            amount: $('#amount').val(),
            firstname: $('#fname').val(),
            email: $('#email').val(),
            phone: $('#mobile').val(),
            productinfo: $('#pinfo').val(),
            udf5: $('#udf5').val(),
            surl: $('#surl').val(),
            furl: $('#surl').val()
        }, {
                responseHandler: function (BOLT) {

                    console.log(BOLT.response.txnStatus);

                    if (BOLT.response.txnStatus != 'CANCEL') {
                        //Salt is passd here for demo purpose only. For practical use keep salt at server side only.
                        var fr = '<form action=\"' + $('#surl').val() + '\" method=\"post\">' +
                            '<input type=\"hidden\" name=\"key\" value=\"' + BOLT.response.key + '\" />' +
                            '<input type=\"hidden\" name=\"salt\" value=\"' + $('#salt').val() + '\" />' +
                            '<input type=\"hidden\" name=\"txnid\" value=\"' + BOLT.response.txnid + '\" />' +
                            '<input type=\"hidden\" name=\"amount\" value=\"' + BOLT.response.amount + '\" />' +
                            '<input type=\"hidden\" name=\"productinfo\" value=\"' + BOLT.response.productinfo + '\" />' +
                            '<input type=\"hidden\" name=\"firstname\" value=\"' + BOLT.response.firstname + '\" />' +
                            '<input type=\"hidden\" name=\"email\" value=\"' + BOLT.response.email + '\" />' +
                            '<input type=\"hidden\" name=\"udf5\" value=\"' + BOLT.response.udf5 + '\" />' +
                            '<input type=\"hidden\" name=\"mihpayid\" value=\"' + BOLT.response.mihpayid + '\" />' +
                            '<input type=\"hidden\" name=\"status\" value=\"' + BOLT.response.status + '\" />' +
                            '<input type=\"hidden\" name=\"hash\" value=\"' + BOLT.response.hash + '\" />' +
                            '<input type=\"hidden\" name=\"service_provider\" value=\"payu_paisa\" />' +
                            '</form>';
                        var form = jQuery(fr);
                        jQuery('body').append(form);
                        form.submit();
                    }
                },
                catchException: function (BOLT) {
                    alert(BOLT.message);
                }
            });
    }

    var getUrlParameter = function getUrlParameter(sParam) {
        var sPageURL = window.location.search.substring(1),
            sURLVariables = sPageURL.split('&'),
            sParameterName,
            i;

        for (i = 0; i < sURLVariables.length; i++) {
            sParameterName = sURLVariables[i].split('=');

            if (sParameterName[0] === sParam) {
                return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
            }
        }
    };
    //--
</script>
